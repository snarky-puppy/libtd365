// tests/td_resolve_host_port_tests.cpp

#define CATCH_CONFIG_MAIN
#include "parsing.h"
#include "types.h"

#include <catch2/catch_all.hpp>
#include <string>
#include <vector>

// clang-format off
static const std::vector<std::string> lines = {
    "870964,104850.50,104910.50,-1147.00,d,1,106498.50,102786.50,O+E4W55s4o+2dEv3T2kaaz+lkLwePRX97aJOsVcIe6c=,0,104880.50,638854057031360000,455503",
    "881586,6332.00,6352.00,-273.00,d,1,6670.00,6170.00,3kbEc9JJ+n/UAYeI0qC69gReU+Wx66IEjKy9rF6nc1Q=,0,0.63,638854056953420000,153442",
    "870964,104850.50,104910.50,-1147.00,d,1,106498.50,102786.50,O+E4W55s4o+2dEv3T2kaaz+lkLwePRX97aJOsVcIe6c=,0,104880.50,638854057031360000,455503",
    "881586,6332.00,6352.00,-273.00,d,1,6670.00,6170.00,3kbEc9JJ+n/UAYeI0qC69gReU+Wx66IEjKy9rF6nc1Q=,0,0.63,638854056953420000,153442",
    "875866,19.1,21.1,-0.7,e,1,21.9,18.6,Plw70iB45ubO6p0Ta0zLe491e1hoX+P0i6Qk3mc8w+I=,0,20.1,638854056980330000,85854",
    "875754,51.6,53.6,-2.9,e,1,57.9,50.4,n5SgBMXJ9Y7YzbUvUedXhjJtErmqr0itRQMXtCio7E8=,0,0.5,638854057023830000,366383",
    "881588,2520.00,2524.00,-119.10,u,1,2663.70,2437.70,TB3gYpK37b3yxxPbT87qqjtGjiE3kmKmYMmyWjOEf8w=,0,2522.00,638854057035180000,613306",
    "875751,834.9,838.9,-28.4,d,1,873.9,811.8,9Pp23Csb9dMfpenMpDW6mSmUkvpBY8mpncdGVr6ns3U=,0,83.6,638854057028430000,239142",
    "875757,54.2,56.2,-3.3,e,1,60.0,53.0,9xiS1aSAndVMTrcCeLweXSHDuFM4KJMRo81zWZZ751s=,0,5.5,638854056966110000,113991",
    "883555,144.25,145.25,-8.50,d,1,154.18,140.47,aVxq/YWXra4UhOH1TLkVVOep8kJzToFjWWXDvT9H4vU=,0,144.75,638854057034500000,467114",
    "875760,257.9,258.9,-10.1,d,1,270.9,253.2,heq6rJbosLscXvEUf0GBueCYDZMfVf6/bp1ce9VH0Go=,0,0.2,638854056942850000,32589",
    "875872,2737.40,2738.40,28.70,d,1,2742.20,2670.90,PtoZ4HXtx26L+dNX2rmGnSEzbsOJ7aa0l6iyit4LC5E=,0,0.27,638854057008890000,106000",
    "881586,6333.00,6353.00,-272.00,u,1,6670.00,6170.00,O7hZW6et5uBIi7vdPopOA5ot79L550SPyQ5TKi3dWLI=,0,0.63,638854057037970000,153443",
    "875866,19.1,21.1,-0.7,e,1,21.9,18.6,Plw70iB45ubO6p0Ta0zLe491e1hoX+P0i6Qk3mc8w+I=,0,20.1,638854056980330000,85854",
    "875754,51.6,53.6,-2.9,e,1,57.9,50.4,n5SgBMXJ9Y7YzbUvUedXhjJtErmqr0itRQMXtCio7E8=,0,0.5,638854057023830000,366383",
    "881588,2520.00,2524.00,-119.10,u,1,2663.70,2437.70,TB3gYpK37b3yxxPbT87qqjtGjiE3kmKmYMmyWjOEf8w=,0,2522.00,638854057035180000,613306",
    "875751,834.9,838.9,-28.4,d,1,873.9,811.8,9Pp23Csb9dMfpenMpDW6mSmUkvpBY8mpncdGVr6ns3U=,0,83.6,638854057028430000,239142",
    "875757,54.2,56.2,-3.3,e,1,60.0,53.0,9xiS1aSAndVMTrcCeLweXSHDuFM4KJMRo81zWZZ751s=,0,5.5,638854056966110000,113991",
    "883555,144.25,145.25,-8.50,d,1,154.18,140.47,aVxq/YWXra4UhOH1TLkVVOep8kJzToFjWWXDvT9H4vU=,0,144.75,638854057034500000,467114",
    "875760,257.9,258.9,-10.1,d,1,270.9,253.2,heq6rJbosLscXvEUf0GBueCYDZMfVf6/bp1ce9VH0Go=,0,0.2,638854056942850000,32589",
    "875872,2737.40,2738.40,28.70,d,1,2742.20,2670.90,PtoZ4HXtx26L+dNX2rmGnSEzbsOJ7aa0l6iyit4LC5E=,0,0.27,638854057008890000,106000",
    "875754,51.6,53.6,-2.9,e,1,57.9,50.4,AsTtZcPObou7A6Ir989Gh+qfy/cJltfS3de4zT21D4I=,0,0.5,638854057039440000,366384",
    "883555,144.26,145.26,-8.49,u,1,154.18,140.47,aVxq/YWXra4UhOH1TLkVVEalZdpKZpQZ/K9WhjQrHT8=,0,144.76,638854057039140000,467115",
    "875754,51.6,53.6,-2.9,e,1,57.9,50.4,3ophruMeSmQfHLGp9ZuApd0WqrapyG3BfqKwRxlckLo=,0,0.5,638854057041950000,366385",
    "875751,835.1,839.1,-28.2,u,1,873.9,811.8,bi3JnznJZ+i8sWjJ0OuI4w32cKyuSldhGjdWVG9xry4=,0,83.7,638854057043460000,239143",
    "883555,144.28,145.28,-8.47,u,1,154.18,140.47,vG+KnRiDNZS0noIK3VY948mRc96uhC5/5uFRWPzv35A=,0,144.78,638854057041820000,467116",
    "883555,144.26,145.26,-8.49,d,1,154.18,140.47,vG+KnRiDNZS0noIK3VY94x12v8NZOuz6cRwkBFGdkg4=,0,144.76,638854057045380000,467117",
    "875866,19.1,21.1,-0.7,e,1,21.9,18.6,hCc5FnU3qhqLochGr7wG9n9kPv3n3jmJDqbeK+IzJSc=,0,20.1,638854057048300000,85855",
    "875751,834.9,838.9,-28.4,d,1,873.9,811.8,bi3JnznJZ+i8sWjJ0OuI4wTsAJ+CqoJ3T+3DEN3Q1yc=,0,83.6,638854057048590000,239144",
    "883555,144.25,145.25,-8.50,d,1,154.18,140.47,vG+KnRiDNZS0noIK3VY9475zVy/wglkaaws/Iuy57VQ=,0,144.75,638854057049470000,467118",
    "883555,144.26,145.26,-8.49,u,1,154.18,140.47,MLUS0NzQ4qoHXgPd8nodd6/r28VXlXwAVTn8Ofo9o3k=,0,144.76,638854057053070000,467119",
    "883555,144.25,145.25,-8.50,d,1,154.18,140.47,MLUS0NzQ4qoHXgPd8nodd+8x338J0oHtx0f6wbaf8gk=,0,144.75,638854057056600000,467120",
    "881586,6332.00,6352.00,-273.00,d,1,6670.00,6170.00,Om6ydYuHop0d4XWTds5MeT5cQJoC4B8SNQ9VpCWAu78=,0,0.63,638854057058760000,153444",
    "881588,2519.90,2523.90,-119.20,d,1,2663.70,2437.70,HJO2nhHIEoB9oDC1969Rx1w+j8+qCH3cBb/J2rISqJQ=,0,2521.90,638854057057970000,613307",
    "883555,144.26,145.26,-8.49,u,1,154.18,140.47,9dax6x3/QbTX3+y+sGddBJIdC7aq/EO+1PYvFf9soGs=,0,144.76,638854057062860000,467121",
    "881586,6333.00,6353.00,-272.00,u,1,6670.00,6170.00,MpZFM/1wcn5A5bXGwuBeqnzF/rSeCSUL+XNIwNmRJHY=,0,0.63,638854057062900000,153445",
    "875754,51.6,53.6,-2.9,e,1,57.9,50.4,RRWjEoF9L40bml/G1A/epXT+LWRLVDeSRH1Mp10LCb0=,0,0.5,638854057064680000,366386",
    "883555,144.25,145.25,-8.50,d,1,154.18,140.47,9dax6x3/QbTX3+y+sGddBH9xX54GfTfS6pYCtXAYNGU=,0,144.75,638854057065550000,467122",
    "875751,835.1,839.1,-28.2,u,1,873.9,811.8,pnk62y27Ab1Onj7O/JGTnb6cGHnXorQOepq0dAvBVhk=,0,83.7,638854057066330000,239145",
    "870964,104870.50,104930.50,-1127.00,u,1,106498.50,102786.50,YRVby2WHBxL8MUW8dyVja843rROX2vhObMBNOCZXbO4=,0,104900.50,638854057070040000,455504",
    "881588,2520.60,2524.60,-118.50,u,1,2663.70,2437.70,cnhzmyqRZz4x/20HoWNWirfX0bgqxEwvMM5eK/39K5M=,0,2522.60,638854057071360000,613309",
    "875751,835.0,839.0,-28.3,d,1,873.9,811.8,Fi7V62KcgjCrxGjhNw9dN0AvzWNLQSVSnHJ+W+v/cbc=,0,83.7,638854057070050000,239146",
    "883555,144.26,145.26,-8.49,u,1,154.18,140.47,2mjwJwGbBIe5E1NRi6Mlq4omT03BmJMtXET+yBOC4AI=,0,144.76,638854057070040000,467123",
    "875760,258.0,259.0,-10.0,u,1,270.9,253.2,RAtE88QtlSsy0dtP5o3hHhsuCXFCDZFLU3/USbQfAgI=,0,0.2,638854057070370000,32590",
    "875872,2738.40,2739.40,29.70,u,1,2742.20,2670.90,BbSsgAqY3dVPdyrp3OL/c/suzUzbVl9nIIYXSLVrbdI=,0,0.27,638854057069330000,106001",
    "870964,104876.50,104936.50,-1121.00,u,1,106498.50,102786.50,YRVby2WHBxL8MUW8dyVja0kNH5vd2HVdhUFxGSQze1Y=,0,104906.50,638854057072980000,455505",
    "881586,6334.00,6354.00,-271.00,u,1,6670.00,6170.00,I/GnU1k/3lFM4H6LijJKXTld1FTHlLr/y2D27TBNR/I=,0,0.63,638854057072880000,153446",
    "881588,2520.80,2524.80,-118.30,u,1,2663.70,2437.70,cnhzmyqRZz4x/20HoWNWiuV1xMFYCaztI6znBe40HMs=,0,2522.80,638854057074250000,613310",
    "875751,835.1,839.1,-28.2,u,1,873.9,811.8,Fi7V62KcgjCrxGjhNw9dN9z3MPsgMbZ8YReqgtK/c5E=,0,83.7,638854057072560000,239147",
    "883555,144.29,145.29,-8.46,u,1,154.18,140.47,2mjwJwGbBIe5E1NRi6Mlq8Fztqg7w9nOg1zggQt15p4=,0,144.79,638854057074530000,467125",
    "875872,2738.50,2739.50,29.80,u,1,2742.20,2670.90,DCt6svnAKLYOgcXfXaEHgktTqbj/XvnuCnrgm4JyGBA=,0,0.27,638854057074380000,106002",
    "870964,104873.50,104933.50,-1124.00,d,1,106498.50,102786.50,YRVby2WHBxL8MUW8dyVjawyEt+OIxaG5qifpym0hGeY=,0,104903.50,638854057076170000,455506",
    "881588,2520.90,2524.90,-118.20,u,1,2663.70,2437.70,cnhzmyqRZz4x/20HoWNWij6jnlZQya3HUuwCbeT2tZA=,0,2522.90,638854057077080000,613311",
    "875751,835.3,839.3,-28.0,u,1,873.9,811.8,Fi7V62KcgjCrxGjhNw9dN8C0qXR/W5L1pGcDzuvtQiE=,0,83.7,638854057075150000,239148",
    "883555,144.28,145.28,-8.47,d,1,154.18,140.47,2mjwJwGbBIe5E1NRi6Mlq1IJ/YL8LrlEHooewXfFiZo=,0,144.78,638854057076840000,467126",
    "870964,104867.50,104927.50,-1130.00,d,1,106498.50,102786.50,YRVby2WHBxL8MUW8dyVja8jnTongsjWtqLPXSkm0/88=,0,104897.50,638854057079820000,455508",
    "881588,2520.50,2524.50,-118.60,d,1,2663.70,2437.70,cnhzmyqRZz4x/20HoWNWirmY/3Goc3nZZYAJPqo09J8=,0,2522.50,638854057078850000,613312",
    "875751,835.2,839.2,-28.1,d,1,873.9,811.8,Fi7V62KcgjCrxGjhNw9dN9x4e4Lr6N/lp+C6URNzkHc=,0,83.7,638854057078530000,239149",
    "881588,2520.40,2524.40,-118.70,d,1,2663.70,2437.70,8rZFoeIucxJxFKGQvy6rv4M0nlfPyoB5aFO3KMVocn4=,0,2522.40,638854057081290000,613313",
    "875751,835.1,839.1,-28.2,d,1,873.9,811.8,gzA22quLexWC7nYKuFOZ9Mh/Tgt8Fexsu+KeHHGEwx0=,0,83.7,638854057083260000,239150",
};

TEST_CASE("Benchmark parse_tick()", "[benchmark]") {
    BENCHMARK("parse each line") {
        td365::tick result;
        for (const auto &line : lines) {
            result = td365::parse_tick(line, td365::grouping::grouped);
        }
        return result;
    };
}

TEST_CASE("Benchmark parse_tick2()", "[benchmark]") {
    BENCHMARK("parse each line") {
        td365::tick result;
        for (const auto &line : lines) {
            result = td365::parse_tick2(line, td365::grouping::grouped);
        }
        return result;
    };
}
